---
title: 运营商劫持
date: 2021-07-08 16:09:37
categories:
- web安全
comments: true
---

常见劫持方式：DNS劫持、HTTP劫持、HTTPS劫持

<!-- more -->



##DNS劫持

- 会将用户重新定位到其他网站
- 熟悉的钓鱼网站就是这个原理
- 具有违法行为，被严厉的监管，已经很少见



##HTTP劫持

- 运营商发现是 http 请求，会在里面插入奇怪的广告（比如一些banner、浮标、更有甚的还有商品位）
- 十分常见



##HTTPS劫持

该劫持方式有两种

1. 伪造证书，通过病毒或其他方式将伪造证书的根证书安装在用户系统中（较少）
2. 通过代理与服务端进行数据交互：代理也有客户的证书与私钥，或者客户端与代理认证的时候不校验合法性（较多）



## 防运营商劫持

- 全站https，能防一部分
- 加入防运营商劫持代码，能防大部分注入性劫持
  - 准确来说是防 script、iframe 注入型劫持，95%以上都是这种劫持方式，因为 DNS 劫持被严管了
- 记录 Log，记录证据，向工信部投诉