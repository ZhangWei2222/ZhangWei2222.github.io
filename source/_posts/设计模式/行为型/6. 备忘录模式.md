---
title: 行为型-备忘录模式
date: 2019-12-24 9:33:47
categories:
- 设计模式
tags:
- 行为型
comments: false
---



## 概念

> Memento Pattern：又叫 Token，在不破坏封装的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态，这样可以在以后将对象恢复到原先保存的状态。

备忘录模式提供了一种状态恢复的实现机制，使得用户可以方便地回到一个特定的历史步骤，当新的状态无效或者存在问题时，可以使用暂时存储起来的备忘录将状态复原，当前很多软件都提供了撤销操作，其中就使用了备忘录模式



## 使用

备忘录模式也可以看成缓存器，除了撤销操作，我们还可以利用该模式做分页：点击下一页获取新的数据，点击上一页时又重新获取数据，会造成流量浪费，这时可以对数据进行缓存

```js
// 备忘录模式伪代码
var Page = function () {
  // 通过cache对象缓存数据
  var cache = {}
  return function (page, fn) {
    if (cache[page]) {
      showPage(page, cache[page])
    } else {
      $.post('/url', function (data) {
        showPage(page, data)
        cache[page] = data
      })
    }
    fn && fn()
  }
}
```



## 优点

- 提供了一种状态恢复的实现机制，使得用户可以方便地回到一个特定的历史步骤，当新的状态无效或者存在问题时，可以使用暂时存储起来的备忘录将状态复原
- 备忘录实现了对信息的封装，一个备忘录对象是一种原发器对象状态的表示，不会被其他代码所改动。备忘录保存了原发器的状态，采用列表、堆栈等集合来存储备忘录对象可以实现多次撤销操作



## 缺点

- 资源消耗过大，如果需要保存的原发器类的成员变量太多，就不可避免需要占用大量的存储空间，每保存一次对象的状态就需要消耗一定的系统资源