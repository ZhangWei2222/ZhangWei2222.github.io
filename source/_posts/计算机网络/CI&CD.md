---
title: CI & CD
date: 2019-12-12 17:09:37
categories:
- 计算机网络
tags:
comments: false
---
简单地说，CI持续集成，需要开发人员尽可能快的提交代码，新提交的代码在最终合并之前会经过编译与自动化测试进行验证；CD持续部署，开发人员点击部署，通过自动化的构建、测试、部署可以快速发布到线上；CD持续交付，可以在持续部署前进行，为持续部署做准备。

实现它们的前提都要有强大的测试用例，和强大的自动化服务。

想起在之前的实习单位，实现部署是在一个平台上，点击部署，上面提示进程：编译、测试、部署...如果中间某个环节出错，就会停止。看来是CD？



### 持续集成（CONTINUOUS INTEGRATION）

在CI环境中，开发人员可以频繁地向主干提交代码，这些新提交的代码在最终合并到主干前，会经过编译和自动化测试流进行验证。

持续集成过程中很重视自动化测试验证结果，以保障所有的提交在合并到主干的质量，对可能出现的问题进行预警。

#### 需要具备的条件

- 团队需要为每个新功能、代码改进、或者问题修复**创建自动化测试用例**
- 需要一个持续集成服务器，它可以**监控**代码提交情况，对每个新的提交进行**自动化测试**
- 研发团队需要**尽可能快的提交代码**，至少每天一次提交

#### 好处

- 通过自动化测试可以提早拿到回归测试的结果，**避免将一些问题**提交到交付生产中
- **发布编译将会更加容易**，因为合并之初已经将所有问题都规避了
- **减少工作问题切换**，研发可以很快获得构建失败的消息，在开始下一个任务之前就可以很快解决
- **测试成本大幅降低**，你的CI服务器可以在几秒钟之内运行上百条测试。
- QA团队**花费在测试上面的时间会大幅缩短**，将会更加侧重于质量文化的提升上面。



### 持续部署（CONTINUOUS DELIVERY）

在CD环境中，通过自动化的构建、测试和部署循环来**快速交付高质量的产品**。

**某种程度上代表了一个开发团队工程化的程度**，任何修改通过了所有已有的工作流就会**直接和客户见面**，只有当一个修改在工作流中构建失败才能阻止它部署到产品线。

**基本上，当开发人员在主分支中合并一个提交时，这个分支将被构建、测试，如果一切顺利，则部署到生产环境中。**

#### 需要具备的条件

- 研发团队测试理念比较完善。**测试单元的健壮性**直接决定交付质量
- **文档**和部署频率要保持一致
- **特征标志**成为发布重大变化过程的固有部分，以确保您可以与其他部门（支持，市场营销，公关…）协调

#### 好处

- **发布频率更快**，因为你不需要停下来等待发布。每一处提交都会自动触发发布流
- 在小批量发布的时候，**风险降低了**，发现问题也可以很轻松的修复
- 客户**每天**都可以看到我们的持续改进和提升，而不是每个月或者每季度，或者每年



### 持续交付（CONTINUOUS DEPLOYMENT）

有时候，持续交付也与持续部署混淆。持续部署意味着所有的变更都会被自动部署到生产环境中。持续交付意味着所有的变更都可以被部署到生产环境中，但是出于业务考虑，可以选择不部署。**如果要实施持续部署，必须先实施持续交付。**


#### 需要具备的条件

- 需要有强大的持续集成组件和足够多的测试项可以满足你代码的需求
- 部署需要自动化。触发是手动的，但是部署一旦开始，就不能人为干预
- 团队可能需要接受特性开关，没有完成的功能模块不会影响到线上产品

#### 好处

- 繁琐的部署工作没有了。团队不在需要花费几天的时间去准备一个发布
- 可以更快的进行交付，这样就加快了与客户之间的反馈环
- 轻松应对小变更，加速迭代