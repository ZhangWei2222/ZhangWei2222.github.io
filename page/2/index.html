<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.2" />






<meta name="description" content="Dream high">
<meta property="og:type" content="website">
<meta property="og:title" content="ZhangWei2222">
<meta property="og:url" content="http://super-wei.xyz/page/2/index.html">
<meta property="og:site_name" content="ZhangWei2222">
<meta property="og:description" content="Dream high">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ZhangWei2222">
<meta name="twitter:description" content="Dream high">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://super-wei.xyz/page/2/"/>





  <title>ZhangWei2222</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ZhangWei2222</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://super-wei.xyz/2017/09/09/商家页面seller-vue/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZhangWei2222">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/person.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZhangWei2222">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/09/商家页面seller-vue/" itemprop="url">商家页面seller.vue</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-09T17:57:35+08:00">
                2017-09-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="主体结构"><a href="#主体结构" class="headerlink" title="主体结构"></a>主体结构</h2><h3 id="html代码"><a href="#html代码" class="headerlink" title="html代码"></a>html代码</h3><pre><code>&lt;div class=&quot;seller&quot; ref=&quot;seller&quot;&gt;
    &lt;div class=&quot;seller-content&quot;&gt;
      &lt;!--overview部分--&gt;
      &lt;div class=&quot;overview&quot;&gt;

      &lt;/div&gt;
      &lt;split&gt;&lt;/split&gt;
      &lt;!--bulltin部分--&gt;
      &lt;div class=&quot;bulletin&quot;&gt;

      &lt;/div&gt;
      &lt;split&gt;&lt;/split&gt;
      &lt;!--pics部分--&gt;
      &lt;div class=&quot;pics&quot;&gt;

      &lt;/div&gt;
      &lt;split&gt;&lt;/split&gt;
      &lt;!--info部分--&gt;
      &lt;div class=&quot;info&quot;&gt;

      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
</code></pre><ul>
<li><p>seller-contentdiv是能够扩大高度的,能够被内容增加而撑高,而seller div是固定的高度的,从而形成滚动</p>
<h3 id="js代码"><a href="#js代码" class="headerlink" title="js代码"></a>js代码</h3><pre><code>import BScroll from &apos;better-scroll&apos;;
import split from &apos;../split/split&apos;;

export default {
  props: {
    seller: { //app.vue里面router-view会传入一个seller
      type: Object
    }
  },
  watch: { //当seller变动的时候会触发
    &apos;seller&apos;() {
      this.$nextTick(() =&gt; {
        this._initScroll();
        this._initPics();
      });
    }
  },
  mounted() { //在dom被渲染之后触发
    this.$nextTick(() =&gt; {
      this._initScroll();
      this._initPics();
    });
  },
  methods: {
    _initScroll() {
      if (!this.scroll) {
        this.scroll = new BScroll(this.$refs.seller, {
          click: true
        });
      } else {
        this.scroll.refresh();
      }
    },
    _initPics() {
      //详细代码在下面,这里暂时先忽略
    }
  },
  components: {
    split
  }
};
</code></pre></li>
</ul>
<ul>
<li>使用watch方法是为了监听数据seller的变化,因为当打开页面的时候,seller是异步获取的,并不一定是能够马上获取,没有seller的数据,相关dom就无法被渲染,并且bscroll是基于dom执行的,所以需要监听seller的变化然后来重新执行相关的初始化函数</li>
</ul>
<ul>
<li>使用mounted方法是为了保证相关dom渲染完成,因为bscroll是基于dom执行的,但是当切换页面的时候,dom会重新渲染,但未必能够马上完成,所以需要在mounted方法里面重新执行相关的初始化函数</li>
</ul>
<ul>
<li><p>关于watch和mounted的使用要基于vue的生命周期来理解vue生命周期</p>
<h3 id="css代码"><a href="#css代码" class="headerlink" title="css代码"></a>css代码</h3><pre><code>.seller
  position: absolute
  top: 174px //给header留空间
  bottom: 0
  left: 0
  width: 100%
  overflow: hidden //隐藏多余部分,因为需要滚动
</code></pre><h2 id="overview部分"><a href="#overview部分" class="headerlink" title="overview部分"></a>overview部分</h2><h3 id="html部分"><a href="#html部分" class="headerlink" title="html部分"></a>html部分</h3><pre><code>&lt;div class=&quot;overview&quot;&gt;
  &lt;h1 class=&quot;title&quot;&gt;{{seller.name}}&lt;/h1&gt;
  &lt;div class=&quot;desc border-1px&quot;&gt;
    &lt;star :size=&quot;36&quot; :score=&quot;seller.score&quot;&gt;&lt;/star&gt;
    &lt;span class=&quot;text&quot;&gt;({{seller.ratingCount}})&lt;/span&gt;
    &lt;span class=&quot;text&quot;&gt;月售{{seller.sellCount}}单&lt;/span&gt;
  &lt;/div&gt;
  &lt;!--列表处理remark内容--&gt;
  &lt;ul class=&quot;remark&quot;&gt;
  &lt;!--使用一个block块包裹内容--&gt;
    &lt;li class=&quot;block&quot;&gt;
    &lt;!--标题用h2标签--&gt;
      &lt;h2&gt;起送价&lt;/h2&gt;
      &lt;!--用content块包裹内容--&gt;
      &lt;div class=&quot;content&quot;&gt;
      &lt;!--用span代表特殊字体--&gt;
        &lt;span class=&quot;stress&quot;&gt;{{seller.minPrice}}&lt;/span&gt;元
      &lt;/div&gt;
    &lt;/li&gt;
    &lt;li class=&quot;block&quot;&gt;
      &lt;h2&gt;商家配送&lt;/h2&gt;
      &lt;div class=&quot;content&quot;&gt;
        &lt;span class=&quot;stress&quot;&gt;{{seller.deliveryPrice}}&lt;/span&gt;元
      &lt;/div&gt;
    &lt;/li&gt;
    &lt;li class=&quot;block&quot;&gt;
      &lt;h2&gt;平均配送时间&lt;/h2&gt;
      &lt;div class=&quot;content&quot;&gt;
        &lt;span class=&quot;stress&quot;&gt;{{seller.deliveryTime}}&lt;/span&gt;分钟
      &lt;/div&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
  &lt;!--收藏按钮--&gt;
  &lt;div class=&quot;favorite&quot; @click=&quot;toggleFavorite&quot;&gt;
    &lt;span class=&quot;icon-favorite&quot; :class=&quot;{&apos;active&apos;:favorite}&quot;&gt;&lt;/span&gt;
    &lt;span class=&quot;text&quot;&gt;{{favoriteText}}&lt;/span&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre><h3 id="js部分"><a href="#js部分" class="headerlink" title="js部分"></a>js部分</h3><pre><code>import BScroll from &apos;better-scroll&apos;;
//引入一个利用html5的localstorage的存储模块
import { saveToLocal, loadFromLocal } from &apos;common/js/store&apos;;

export default {
  props: {
    seller: {
      type: Object
    }
  },
  data() {
    return {
      favorite: (() =&gt; { 
      //利用localstorage读取这个属性
        return loadFromLocal(this.seller.id, &apos;favorite&apos;, false);
      })()//vue需要返回的data必须是函数,所以加上()
    };
  },
  computed: {
    favoriteText() { //通过favorite的值来计算favoriteText的值
      return this.favorite ? &apos;已收藏&apos; : &apos;收藏&apos;;
    }
  },
  methods: {
    toggleFavorite(event) {
      if (!event._constructed) {
        return;
      }
      //通过取反来设置切换
      this.favorite = !this.favorite;
      //利用localstorage存储这个属性
      saveToLocal(this.seller.id, &apos;favorite&apos;, this.favorite);
    }
  }
};
</code></pre></li>
</ul>
<ul>
<li>store.js参考:split,formatDate,store,util组件<h3 id="css部分"><a href="#css部分" class="headerlink" title="css部分"></a>css部分</h3>  .overview<pre><code>position: relative //设置相对布局参考位置
padding: 18px
.title
  margin-bottom: 8px
  line-height: 14px
  color: rgb(7, 17, 27)
  font-size: 14px
.desc
  padding-bottom: 18px
  border-1px(rgba(7, 17, 27, 0.1))
  font-size: 0
  .star
    display: inline-block
    margin-right: 8px
    vertical-align: top //行内对齐
  .text
    display: inline-block
    margin-right: 12px
    line-height: 18px
    vertical-align: top //行内对齐
    font-size: 10px
    color: rgb(77, 85, 93)
.remark
  display: flex //flex布局
  padding-top: 18px
  .block
    flex: 1 //flex布局等分区域
    text-align: center
    border-right: 1px solid rgba(7, 17, 27, 0.1)
    &amp;:last-child
      border: none
    h2
      margin-bottom: 4px
      line-height: 10px
      font-size: 10px
      color: rgb(147, 153, 159)
    .content //设置该块的公共属性
      line-height: 24px
      font-size: 10px
      color: rgb(7, 17, 27)
      .stress //特殊大小再插入class覆盖
        font-size: 24px
.favorite
  position: absolute
  width: 50px //设置一个固定宽度,被text-align使用
  right: 11px
  top: 18px
  text-align: center
  .icon-favorite
    display: block
    margin-bottom: 4px
    line-height: 24px
    font-size: 24px
    color: #d4d6d9
    &amp;.active
      color: rgb(240, 20, 20)
  .text
    line-height: 10px
    font-size: 10px
    color: rgb(77, 85, 93)
</code></pre><h2 id="bulletin部分"><a href="#bulletin部分" class="headerlink" title="bulletin部分"></a>bulletin部分</h2><h3 id="html代码-1"><a href="#html代码-1" class="headerlink" title="html代码"></a>html代码</h3>  <div class="bulletin"><br>          <h1 class="title">公告与活动</h1><br>          <div class="content-wrapper border-1px"><br>            <p class="content"></p><br>          </div><br>          <ul v-if="seller.supports" class="supports"><br>            <li class="support-item border-1px" v-for="(item,index) in seller.supports"><br>            <!--使用classMap做对应--><br>              <span class="icon" :class="classMap[seller.supports[index].type]"></span><br>              <span class="text"></span><br>            </li><br>          </ul><br>        </div>


</li>
</ul>
<blockquote>
<p>classMap的原理(classMap使用在之前的header组件使用过Header.vue)</p>
</blockquote>
<ul>
<li>seller.supports的结构是这样的<br>  “supports”: [<pre><code>  {
    &quot;type&quot;: 0,
    &quot;description&quot;: &quot;在线支付满28减5&quot;
  },
  {
    &quot;type&quot;: 1,
    &quot;description&quot;: &quot;VC无限橙果汁全场8折&quot;
  },
  {
    &quot;type&quot;: 2,
    &quot;description&quot;: &quot;单人精彩套餐&quot;
  },
  {
    &quot;type&quot;: 3,
    &quot;description&quot;: &quot;该商家支持发票,请下单写好发票抬头&quot;
  },
  {
    &quot;type&quot;: 4,
    &quot;description&quot;: &quot;已加入“外卖保”计划,食品安全保障&quot;
  }
],
</code></pre></li>
</ul>
<ul>
<li>classMap是[‘decrease’, ‘discount’, ‘special’, ‘invoice’, ‘guarantee’]这样的,这个顺序是按照设计需要和数据结构排的,例如type为0对应在线支付满28减5</li>
</ul>
<ul>
<li>如果要获取对应的class,就可以classMap[seller.supports[index].type],例如seller.supports[0].type就是0,那么就是classMap[0]就是decrease这个class</li>
</ul>
<ul>
<li><p>如果要获取对应的description就可以seller.supports[index].description,例如seller.supports[0].description就直接知道了supports数组的第一个元素的description属性的值了</p>
<h3 id="js代码-1"><a href="#js代码-1" class="headerlink" title="js代码"></a>js代码</h3><pre><code>import split from &apos;../split/split&apos;;

export default {
  props: {
    seller: {
      type: Object
    }
  },
  created() { //使用自建的一个classMap数组来对应不同的类别
    this.classMap = [&apos;decrease&apos;, &apos;discount&apos;, &apos;special&apos;, &apos;invoice&apos;, &apos;guarantee&apos;];
  },
  components: {
    split
  }
};
</code></pre></li>
</ul>
<ul>
<li>使用created方法是为了在加载的时候第一时间完成,因为vue的渲染需要this.classMap属性(created是vue的生命周期的第一个)<h3 id="css代码-1"><a href="#css代码-1" class="headerlink" title="css代码"></a>css代码</h3>  @import “../../common/stylus/mixin.styl”<pre><code>.bulletin
  padding: 18px 18px 0 18px
  .title
    margin-bottom: 8px
    line-height: 14px
    color: rgb(7, 17, 27)
    font-size: 14px
  .content-wrapper
    padding: 0 12px 16px 12px
    border-1px(rgba(7, 17, 27, 0.1))
    .content
      line-height: 24px
      font-size: 12px
      color: rgb(240, 20, 20)
  .supports
    .support-item
      padding: 16px 12px
      border-1px(rgba(7, 17, 27, 0.1))
      font-size: 0
      &amp;:last-child
        border-none() //需要引入一个mixin,处理没边框的问题
    .icon
      display: inline-block
      width: 16px
      height: 16px
      vertical-align: top
      margin-right: 6px
      background-size: 16px 16px
      background-repeat: no-repeat
      &amp;.decrease //使用设计要求的大小的图标
        bg-image(&apos;decrease_4&apos;) //使用mixin处理这些图标
      &amp;.discount
        bg-image(&apos;discount_4&apos;)
      &amp;.guarantee
        bg-image(&apos;guarantee_4&apos;)
      &amp;.invoice
        bg-image(&apos;invoice_4&apos;)
      &amp;.special
        bg-image(&apos;special_4&apos;)
    .text
      line-height: 16px
      font-size: 12px
      color: rgb(7, 17, 27)
</code></pre><h2 id="pics部分"><a href="#pics部分" class="headerlink" title="pics部分"></a>pics部分</h2><h3 id="html代码-2"><a href="#html代码-2" class="headerlink" title="html代码"></a>html代码</h3>  <div class="pics"><br>          <h1 class="title">商家实景</h1><br>          <!--两个ref绑定picWrapper,picList--><br>          <div class="pic-wrapper" ref="picWrapper"><br>          <!--列表循环输出图片--><br>            <ul class="pic-list" ref="picList"><br>              <li class="pic-item" v-for="pic in seller.pics"><br>              <!--固定图片尺寸--><br>                <img :src="pic" width="120" height="90"><br>              </li><br>            </ul><br>          </div><br>  </div>


</li>
</ul>
<ul>
<li>ref获取picWrapper是为了滚动图片需要,父DOM是picWrapper,子DOM是picList</li>
</ul>
<ul>
<li>ref获取picList是为了计算图片列表的总长度,用来设置图片列表的横向滚动,因为滚动的触发条件是子DOM比父DOM要”大”的时候才会触发,由于图片的数量是未知的,所以需要去计算,然后写入到picList<h3 id="js代码-2"><a href="#js代码-2" class="headerlink" title="js代码"></a>js代码</h3>  _initPics() { //编程习惯的前置下划线,代表内部使用的方法<pre><code>if (this.seller.pics) {
  let picWidth = 120; //
  let margin = 6;
  //这是图片列表的总长度
  let width = (picWidth + margin) * this.seller.pics.length - margin;
  //设置图片列表的宽度等于列表的总长度
  this.$refs.picList.style.width = width + &apos;px&apos;;
  //异步绑定滚动
  this.$nextTick(() =&gt; {
    if (!this.picScroll) {
      this.picScroll = new BScroll(this.$refs.picWrapper, {
        scrollX: true, //bscroll的横向滚动属性
        eventPassthrough: &apos;vertical&apos; //bscroll的过滤垂直滚动
      });
    } else {
      this.picScroll.refresh();
    }
  });
}
</code></pre></li>
</ul>
<ul>
<li>一般来说,当某页面本身是垂直滚动的时候,中间的某个DOM需要做横向滚动的话,需要处理滚动坐标的变化,例如手势滚动的时候有x,y坐标,是向上,下,左还是右会区分</li>
</ul>
<ul>
<li>图片列表的总长度是单个图片的宽度+单个图片的外边距的和乘以图片的数量,再减去最后一个图片的外边距</li>
</ul>
<ul>
<li>BScroll插件需要增加一个属性scrollX: true来传入横向的滚动坐标,也需要增加一个属性eventPassthrough: ‘vertical’过滤垂直的滚动,前者已经解释过,后者是因为需要横向滚动的页面是内嵌在垂直滚动的页面的里面的,所以会造成外面的垂直滚动事件也会传入到横向滚动的页面,为了避免影响横向滚动,所以需要屏蔽垂直滚动的事件</li>
</ul>
<ul>
<li>我们平时在做这种滚动内嵌滚动的时候也可以参考这个处理方法.</li>
</ul>
<ul>
<li>另外异步绑定滚动的常规做法,先判断是否已经有BScroll实例了,然后再确定是否需要刷新<h3 id="css代码-2"><a href="#css代码-2" class="headerlink" title="css代码"></a>css代码</h3>  .pics<pre><code>padding: 18px
.title
  margin-bottom: 12px
  line-height: 14px
  color: rgb(7, 17, 27)
  font-size: 14px
.pic-wrapper
  width: 100% //图片列表区域是屏幕宽度
  overflow: hidden //隐藏多余部分
  white-space: nowrap  //连续的空白符会被合并
  .pic-list
    font-size: 0 //行内元素取消间隙
    .pic-item
      display: inline-block
      margin-right: 6px
      width: 120px
      height: 90px
      &amp;:last-child //最后一个图片没有外边距
        margin: 0
</code></pre><h2 id="info部分"><a href="#info部分" class="headerlink" title="info部分"></a>info部分</h2><h3 id="html代码-3"><a href="#html代码-3" class="headerlink" title="html代码"></a>html代码</h3><pre><code>&lt;div class=&quot;info&quot;&gt;
  &lt;h1 class=&quot;title border-1px&quot;&gt;商家信息&lt;/h1&gt;
  &lt;ul&gt;
    &lt;li class=&quot;info-item&quot; v-for=&quot;info in seller.infos&quot;&gt;{{info}}&lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre><h3 id="css代码-3"><a href="#css代码-3" class="headerlink" title="css代码"></a>css代码</h3>  .info<pre><code>padding: 18px 18px 0 18px
color: rgb(7, 17, 27)
.title
  padding-bottom: 12px
  line-height: 14px
  border-1px(rgba(7, 17, 27, 0.1))
  font-size: 14px
.info-item
  padding: 16px 12px
  line-height: 16px
  border-1px(rgba(7, 17, 27, 0.1)) //1像素的border 的mixin
  font-size: 12px
  &amp;:last-child
    border-none() //没有border的mixin
</code></pre></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://super-wei.xyz/2017/09/09/商品详情页food-vue/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZhangWei2222">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/person.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZhangWei2222">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/09/商品详情页food-vue/" itemprop="url">商品详情页food.vue</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-09T17:57:19+08:00">
                2017-09-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="主体结构"><a href="#主体结构" class="headerlink" title="主体结构"></a>主体结构</h2><h3 id="html代码"><a href="#html代码" class="headerlink" title="html代码"></a>html代码</h3><pre><code>&lt;template&gt;
  &lt;transition name=&quot;move&quot;&gt;
  &lt;!--要实现这个商品详情页的内容滚动,所以需要有一个显示标志和一个dom绑定--&gt;
  &lt;div v-show=&quot;showFlag&quot; class=&quot;food&quot; ref=&quot;food&quot;&gt;
  &lt;/div&gt;
  &lt;/transition&gt;
&lt;/template&gt;    
</code></pre><ul>
<li>用ref绑定food的DOM元素,为了被bscroll做滚动处理</li>
</ul>
<ul>
<li>用transition包裹了整个food,为了实现这个页面的进入和退出动画<h3 id="js代码"><a href="#js代码" class="headerlink" title="js代码"></a>js代码</h3><pre><code>import BScroll from &apos;better-scroll&apos;;
export default {
  props: {
    food: {
      type: Object
    }
  },
  data(){
    return {
      showFlag: false 
    }
  },
  methods: {
    show(){
      this.showFlag = true; 
      this.$nextTick(() =&gt; { //异步添加滚动绑定
        if (!this.scroll) {
          this.scroll = new BScroll(this.$refs.food, {
            click: true
          });
        } else {
          this.scroll.refresh();
        }
      })
    },
    hide(){
      this.showFlag = false;
    }
}
</code></pre></li>
</ul>
<ul>
<li>通过跟hide方法切换showFlag的值来实现显示隐藏</li>
</ul>
<ul>
<li>因为整个页面是比较长的,需要做滚动,所以异步加载bscroll<h3 id="css代码"><a href="#css代码" class="headerlink" title="css代码"></a>css代码</h3><pre><code>.food
  position: fixed //霸占屏幕,全屏显示,所以用fixed布局
  left: 0
  top: 0
  bottom: 48px //保留底部购物车底部栏的位置
  z-index: 30 //z-index的数值是有考究的,要控制好各个页面的z-index纵深
  width: 100%
  background: #fff
  transform: translate3d(0, 0, 0)
  &amp;.move-enter-active, &amp;.move-leave-active //用vue的动画配置实现动画
    transition: all 0.2s linear
  &amp;.move-enter, &amp;.move-leave-active
    transform: translate3d(100%, 0, 0)
</code></pre></li>
</ul>
<ul>
<li>对于整个商品详情页的打开和关闭效果体验,需要对其做动画处理,transition</li>
</ul>
<ul>
<li>动画是3d变形,从右往左(改变的是x坐标),直线移动(linear)<h2 id="商品封面"><a href="#商品封面" class="headerlink" title="商品封面"></a>商品封面</h2><h3 id="html代码-1"><a href="#html代码-1" class="headerlink" title="html代码"></a>html代码</h3>  <div class="image-header"><pre><code>&lt;img :src=&quot;food.image&quot;&gt;
&lt;!--有一个返回按钮,绑定一个hide方法--&gt;
&lt;div class=&quot;back&quot; @click=&quot;hide&quot;&gt;
&lt;!--使用icon--&gt;
  &lt;i class=&quot;icon-arrow_lift&quot;&gt;&lt;/i&gt; 
&lt;/div&gt;
</code></pre>  </div><h3 id="js代码-1"><a href="#js代码-1" class="headerlink" title="js代码"></a>js代码</h3><pre><code>export default {
  props: {
    food: { //用goods.vue组件传入的food数据
      type: Object
    }
  }
}
</code></pre></li>
</ul>
<ul>
<li>在goods.vue组件上传入的food数据<food @add="addFood" :food="selectedFood" ref="food" \=""><h3 id="css代码-1"><a href="#css代码-1" class="headerlink" title="css代码"></a>css代码</h3>  .image-header<pre><code>position: relative
width: 100%
height: 0
padding-top: 100% //这是一个css-hack技巧
img
  position: absolute
  top: 0
  left: 0
  width: 100% //图片撑满整个img的div
  height: 100%
.back
  position: absolute
  top: 10px
  left: 0
  .icon-arrow_lift //返回按钮,使用的是icon的那个css
    display: block
    padding: 10px
    font-size: 20px
    color: #fff
</code></pre></food></li>
</ul>
<ul>
<li>在w3c规定里面,padding设置100%的时候,这个值的计算是相对于这个盒子模型的宽度计算的,然后现在是宽是100%,所以padding也是100%,然后使用的是padding-top,那么就是内上边距的高度就是宽度的值,所以这样就能自然撑开一个正方形,这样的目的在于页面打开的时候更自然,不会出现闪烁<h2 id="商品标题"><a href="#商品标题" class="headerlink" title="商品标题"></a>商品标题</h2><h3 id="html代码-2"><a href="#html代码-2" class="headerlink" title="html代码"></a>html代码</h3>  <div class="content"><br>    <h1 class="title"></h1><br>    <div class="detail"><br>      <span class="sell-count">月售份</span><br>      <span class="rating">好评率%</span><br>    </div><br>    <div class="price"><br>      <span class="now">￥</span><span class="old" v-show="food.oldPrice">￥</span><br>    </div><br>    <!--引入cartcontrol组件,并且用一个div包裹他--><br>    <div class="cartcontrol-wrapper"><br>      <cartcontrol @add="addFood" :food="food"></cartcontrol><br>    </div><br>    <transition name="fade"><br>    <!--使用.stop.prevent阻止冒泡和默认事件,避免穿透--><br>      <div @click.stop.prevent="addFirst" class="buy" v-show="!food.count || food.count===0"><br>        加入购物车<br>      </div><br>    </transition><br>  </div>


</li>
</ul>
<ul>
<li>加入购物车按钮有一个动画fade,并且因为他的位置跟cartcontrol有重叠,避免穿透,所以直接.click.stop.prevent<br>加入购物车按钮的显示是通过判断food.count实现的,这个属性默认是没有的,当点击购物车按钮的时候强制生成Vue.set(this.food, ‘count’, 1);,这样做的目的是比较直观的增加一个属性去实现功能</li>
</ul>
<ul>
<li><p>cartcontrol的使用跟一般组件使用差不多.</p>
<h3 id="js代码-2"><a href="#js代码-2" class="headerlink" title="js代码"></a>js代码</h3><pre><code>import BScroll from &apos;better-scroll&apos;;
import Vue from &apos;vue&apos;;
import cartcontrol from &apos;../../components/cartcontrol/cartcontrol&apos;;

export default {
  props: {
    food: {
      type: Object
    }
  }
  methods: {
    addFirst(event){ //点击加入购物车按钮,传入事件
      if (!event._constructed) { //因为购物车按钮在bscroll里面,所以需要处理掉bscroll的事件类型
        return;
      }
      this.$emit(&apos;add&apos;, event.target); //触发当前实例food上的事件add(在goods组件上绑定在food组件的add方法)
      Vue.set(this.food, &apos;count&apos;, 1);
    },
    addFood(target) { //跟add关联的addFood方法
      this.$emit(&apos;add&apos;, target); //触发当前实例food上的事件add(在goods组件上绑定在food组件的add方法)
    }
  },
  components: {
    cartcontrol
  }
}
</code></pre></li>
</ul>
<ul>
<li>两次触发当前实例的事件add是因为两个操作都是同一个动作,这个动作是绑定在food组件上的add方法,而food组件会在goods组件中被导入<food @add="addFood" :food="selectedFood" ref="food"></food>,而在goods组件里面,addFood方法就会指向当前goods组件的方法_drop,继而使用shopcart的小球抛物线动画this.$refs.shopcart.drop(target);,这样就是实现了使用跨组件调用方法的效果.<h3 id="css代码-2"><a href="#css代码-2" class="headerlink" title="css代码"></a>css代码</h3>  .content<pre><code>position: relative
padding: 18px
.title
  line-height: 14px
  margin-bottom: 8px
  font-size: 14px
  font-weight: 700
  color: rgb(7, 17, 27)
.detail
  margin-bottom: 18px
  line-height: 10px
  height: 10px
  font-size: 0 //注意行内元素的空格
  .sell-count, .rating
    font-size: 10px
    color: rgb(147, 153, 159)
  .sell-count
    margin-right: 12px
.price //这里的css样式就是在goods.vue出现过的样式,所以直接贴过来使用,也可以做成组件
  font-weight: 700
  line-height: 24px
  .now
    margin-right: 8px
    font-size: 14px
    color: rgb(240, 20, 20)
  .old
    text-decoration: line-through
    font-size: 10px
    color: rgb(147, 153, 159)
.cartcontrol-wrapper //固定cartcontrol组件的样式
  position: absolute
  right: 12px
  bottom: 12px
.buy //加入购物车按钮的样式
  position: absolute
  right: 18px
  bottom: 18px
  z-index: 10 //显示在cartcontrol的更外面
  height: 24px
  line-height: 24px
  padding: 0 12px
  box-sizing: border-box //不希望padding和border把整个div撑大
  border-radius: 12px
  font-size: 10px
  color: #fff
  background: rgb(0, 160, 220)
  opacity: 1 //加入动画,一个是为了体验,另外一个是为了延迟触发隐藏,避免小球抛物线动画出现问题
  &amp;.fade-enter-active, &amp;.fade-leave-active
    transition: all 0.2s
  &amp;.fade-enter, &amp;.fade-leave-active
    opacity: 0
    z-index: -1
</code></pre></li>
</ul>
<ul>
<li>这里的z-index是10,因为加入购物车按钮和cartcontrol的按钮重叠了,所以需要设置一个比较靠外的z坐标</li>
</ul>
<ul>
<li>这里的box-sizing可以直观的设置盒子模型的实际大小,而不用计算边框和内边距的影响,<br>这是box-sizing:border-size之后的图,注意这个auto,这是因为盒子的大小被固定了,边框和内边距也是固定的,然后内容会根据被固定的大小进行auto适配,这种从外到内的空间设置比较直观和方便</li>
</ul>
<p><img src="http://oncweb6po.bkt.clouddn.com/1480597-fa20b7741a01637b.png" alt=""></p>
<ul>
<li>这里加入动画的原因是当点击加入购物车的按钮时候(addFirst),因为food.count被添加了数据Vue.set(this.food, ‘count’, 1);,所以加入购物车按钮会被隐藏(v-show的display:none),但同时会执行this.$emit(‘add’, event.target);,只不过这个是异步执行的,并且这个被异步执行的方法add是抛物线小球动画计算初始目标高度的地方,所以当传入的购物车按钮被设置为display:none的时候,动画的目标初始高度无法计算,就会去使用父层div的高度,从而影响了抛物线小球动画效果.</li>
</ul>
<pre><code>- 设置一个动画延迟隐藏购物车按钮,从而给足够的时间vue将数据传递到异步执行的方法,不影响抛物线小球的动画初始目标计算
</code></pre><h2 id="商品信息"><a href="#商品信息" class="headerlink" title="商品信息"></a>商品信息</h2><pre><code>&lt;!--引入split组件负责隔离行--&gt;
        &lt;split v-show=&quot;food.info&quot;&gt;&lt;/split&gt;
        &lt;div class=&quot;info&quot; v-show=&quot;food.info&quot;&gt;
          &lt;h1 class=&quot;title&quot;&gt;商品信息&lt;/h1&gt;
          &lt;p class=&quot;text&quot;&gt;{{food.info}}&lt;/p&gt;
        &lt;/div&gt;
  import split from &apos;../../components/split/split&apos;;

  export default {
    props: {
      food: {
        type: Object
      }
    },
    components: {
      split
    }
  }
    .info
      padding: 18px
      .title
        line-height: 14px
        margin-bottom: 6px
        font-size: 14px
        color: rgb(7, 17, 27)
      .text
        line-height: 24px
        padding: 0 8px
        font-size: 12px
        color: rgb(77, 85, 93)
</code></pre><h2 id="商品评价"><a href="#商品评价" class="headerlink" title="商品评价"></a>商品评价</h2><h3 id="html代码-3"><a href="#html代码-3" class="headerlink" title="html代码"></a>html代码</h3><pre><code>&lt;div class=&quot;rating&quot;&gt;
          &lt;h1 class=&quot;title&quot;&gt;商品评价&lt;/h1&gt;
          &lt;!--ratingselect组件--&gt;
          &lt;ratingselect @select=&quot;selectRating&quot; @toggle=&quot;toggleContent&quot; :selectType=&quot;selectType&quot;
                        :onlyContent=&quot;onlyContent&quot; :desc=&quot;desc&quot;
                        :ratings=&quot;food.ratings&quot;&gt;&lt;/ratingselect&gt;
          &lt;div class=&quot;rating-wrapper&quot;&gt;
          &lt;!--根据ratings长度显示ratings--&gt;
            &lt;ul v-show=&quot;food.ratings &amp;&amp; food.ratings.length&quot;&gt;
            &lt;!--根据不同类型的rateType来切换不同类型的rate--&gt;
              &lt;li v-show=&quot;needShow(rating.rateType,rating.text)&quot; v-for=&quot;rating in food.ratings&quot; class=&quot;rating-item border-1px&quot;&gt;
                &lt;div class=&quot;user&quot;&gt;
                  &lt;span class=&quot;name&quot;&gt;{{rating.username}}&lt;/span&gt;
                  &lt;img class=&quot;avatar&quot; width=&quot;12&quot; height=&quot;12&quot; :src=&quot;rating.avatar&quot;&gt;
                &lt;/div&gt;
                &lt;!--使用vue过滤器filter来处理时间--&gt;
                &lt;div class=&quot;time&quot;&gt;{{rating.rateTime | formatDate}}&lt;/div&gt;
                &lt;p class=&quot;text&quot;&gt;
                &lt;!--根据不同类型的rateType来控制icon的显示--&gt;
                  &lt;span
                    :class=&quot;{&apos;icon-thumb_up&apos;:rating.rateType===0,&apos;icon-thumb_down&apos;:rating.rateType===1}&quot;&gt;&lt;/span&gt;
                    {{rating.text}}
                &lt;/p&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
            &lt;!--没有rate的时候显示--&gt;
            &lt;div class=&quot;no-rating&quot; v-show=&quot;!food.ratings || !food.ratings.length&quot;&gt;&lt;/div&gt;
          &lt;/div&gt;
        &lt;/div&gt;
</code></pre><ul>
<li>绑定一个ratingselect组件,负责处理rate选择的</li>
</ul>
<ul>
<li>然后划分一个rating-wrapper区域,负责显示相关rate的信息</li>
</ul>
<ul>
<li>在子组件ratingselect选择的信息会影响到父组件的rating-wrapper区域内容的变化</li>
</ul>
<pre><code>- needShow控制当前rate的内容显示,包括不同的type和是否排除没内容的rate


- 绑定icon-thumb_up和icon-thumb_down的class来控制赞和批评的icon显示


- 根据json数据里面的ratings数组来控制是否显示rate
</code></pre><h3 id="js代码-3"><a href="#js代码-3" class="headerlink" title="js代码"></a>js代码</h3><pre><code>const ALL = 2; //将控制type类转为常量控制

import Vue from &apos;vue&apos;;
import ratingselect from &apos;../../components/ratingselect/ratingselect&apos;; //引入ratingselect组件

export default {
  props: {
    food: {
      type: Object
    }
  },
  data(){
    return { //这些是传入ratingselect组件的数据,并且初始化值
      selectType: ALL, //默认所有rate
      onlyContent: true, //默认只显示有内容的rate
      desc: {
        all: &apos;全部&apos;,
        positive: &apos;推荐&apos;,
        negative: &apos;吐槽&apos;
      }
    }
  },
  methods: {
    needShow(type, text){ 
      if (this.onlyContent &amp;&amp; !text) { //只显示有内容的 并且 没有内容就返回false
        return false;
      }

      if (this.selectType === ALL) { //显示全部类型的rate
        return true;
      } else { //只显示对应的类型的rate
        return type === this.selectType;
      }
    },
    selectRating(type) { //设置rate的类型
      this.selectType = type;
      this.$nextTick(() =&gt; {//切换的时候需要重新刷新bscroll
        this.scroll.refresh();
      });
    },
    toggleContent() { //切换显示是否有内容的rate
      this.onlyContent = !this.onlyContent;
      this.$nextTick(() =&gt; { //切换的时候需要重新刷新bscroll
        this.scroll.refresh();
      });
    }
  },
  components: {
    ratingselect
  }
}
</code></pre><ul>
<li>selectRating和toggleContent使用异步$nextTick是因为vue是异步更新dom的,当改变了vue属性时候,当前的dom不是立即更新的(会导致页面的高度变化了,但是bscroll来不及更新,影响滚动体验),而是会放进去异步更新队列里面等候更新,即使这个队列的等待时间不长,但是也来不及马上更新dom,所以使用$nextTick强制刷新这个队列</li>
</ul>
<ul>
<li>在food.vue组件使用selectRating和toggleContent来更新food.vue组件的属性,而不能在子组件ratingselect里面更新,因为vue限制了子组件不能更改父组件的属性,所以通过使用类似this.$emit(‘select’, type);来调用父组件的方法来更改</li>
</ul>
<h3 id="css代码-3"><a href="#css代码-3" class="headerlink" title="css代码"></a>css代码</h3><pre><code>.rating
  padding-top: 18px
  .title
    line-height: 14px
    margin-bottom: 6px
    font-size: 14px
    color: rgb(7, 17, 27)
  .rating-wrapper
    padding: 0 18px
    .rating-item
      position: relative;
      padding: 16px 0;
      border-1px(rgba(7, 17, 27, 0.1))
      .user
        position: absolute
        right: 0
        top: 16px
        line-height: 12px
        font-size: 0 //注意行内元素的空隙
        .name
          display: inline-block
          margin-right: 6px
          vertical-align: top
          font-size: 10px
          color: rgb(147, 153, 159)
        .avatar
          border-radius: 50%
      .time
        margin-bottom: 6px
        line-height: 12px
        font-size: 10px
        color: rgb(147, 153, 159)
      .text
        line-height: 16px
        font-size: 12px
        color: rgb(7, 17, 27)
        .icon-thumb_up, .icon-thumb_down 
          margin-right: 4px
          line-height: 16px
          font-size: 12px
        .icon-thumb_up
          color: rgb(0, 160, 220)
        .icon-thumb_down
          color: rgb(147, 153, 159)
    .no-rating
      padding: 16px 0
      font-size: 12px
      color: rgb(147, 153, 159)
</code></pre><p>商品评价里的时间处理<br>split组件和formatDate组件</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://super-wei.xyz/2017/09/09/shopcart-vue/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZhangWei2222">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/person.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZhangWei2222">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/09/shopcart-vue/" itemprop="url">shopcart.vue</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-09T17:57:03+08:00">
                2017-09-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="html代码"><a href="#html代码" class="headerlink" title="html代码"></a>html代码</h2><pre><code>&lt;template&gt;
&lt;!--vue的render渲染需要有一个root的根dom层,所以创建一个单独的div来包裹--&gt;
  &lt;div&gt;
  &lt;!--这是shopcart的主代码--&gt;
    &lt;div class=&quot;shopcart&quot;&gt;
    &lt;!--用toggleList点击显示隐藏购物车列表--&gt;
      &lt;div class=&quot;content&quot; @click=&quot;toggleList&quot;&gt;
        &lt;div class=&quot;content-left&quot;&gt;
          &lt;div class=&quot;logo-wrapper&quot;&gt;
            &lt;div class=&quot;logo&quot; :class=&quot;{&apos;highlight&apos;:totalCount&gt;0}&quot;&gt;
              &lt;i class=&quot;icon-shopping_cart&quot; :class=&quot;{&apos;highlight&apos;:totalCount&gt;0}&quot;&gt;&lt;/i&gt;
            &lt;/div&gt;
            &lt;div class=&quot;num&quot; v-show=&quot;totalCount&gt;0&quot;&gt;{{totalCount}}&lt;/div&gt;
          &lt;/div&gt;
          &lt;div class=&quot;price&quot; :class=&quot;{&apos;highlight&apos;:totalPrice&gt;0}&quot;&gt;￥{{totalPrice}}&lt;/div&gt;
          &lt;div class=&quot;desc&quot;&gt;另需配送费￥{{deliveryPrice}}元&lt;/div&gt;
        &lt;/div&gt;
        &lt;!--支付--&gt;
        &lt;div class=&quot;content-right&quot; @click.stop.prevent=&quot;pay&quot;&gt;
        &lt;!--这里class绑定的是一个payClass计算属性--&gt;
          &lt;div class=&quot;pay&quot; :class=&quot;payClass&quot;&gt;
            {{payDesc}}
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;!--省略了ball-container是动画小球的部分--&gt;
      &lt;!--shopcart的列表详情部分--&gt;
      &lt;transition name=&quot;fold&quot;&gt;
        &lt;div class=&quot;shopcart-list&quot; v-show=&quot;listShow&quot;&gt;
          &lt;div class=&quot;list-header&quot;&gt;
            &lt;h1 class=&quot;title&quot;&gt;购物车&lt;/h1&gt;
            &lt;span class=&quot;empty&quot; @click=&quot;empty&quot;&gt;清空&lt;/span&gt;
          &lt;/div&gt;
          &lt;div class=&quot;list-content&quot; ref=&quot;listContent&quot;&gt;
            &lt;ul&gt;
              &lt;li class=&quot;food&quot; v-for=&quot;food in selectFoods&quot;&gt;
                &lt;span class=&quot;name&quot;&gt;{{food.name}}&lt;/span&gt;
                &lt;div class=&quot;price&quot;&gt;
                  &lt;span&gt;￥{{food.price * food.count}}&lt;/span&gt;
                &lt;/div&gt;
                &lt;!--列表里面可以进行操作,所以会复用一个cartcontrol的组件--&gt;
                &lt;div class=&quot;cartcontrol-wrapper&quot;&gt;
                  &lt;cartcontrol @add=&quot;addFood&quot; :food=&quot;food&quot;&gt;&lt;/cartcontrol&gt;
                &lt;/div&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/transition&gt;
    &lt;/div&gt;
    &lt;!--打开shopcart列表的时候背景需要虚化并且动画--&gt;
    &lt;transition name=&quot;fade&quot;&gt;
      &lt;div class=&quot;list-mask&quot; @click=&quot;hideList&quot; v-show=&quot;listShow&quot;&gt;&lt;/div&gt;
    &lt;/transition&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre><h2 id="js代码"><a href="#js代码" class="headerlink" title="js代码"></a>js代码</h2><pre><code>import BScroll from &apos;better-scroll&apos;;
import cartcontrol from &apos;../../components/cartcontrol/cartcontrol&apos;;

export default{
  props: {
    selectFoods: {
      type: Array,
      default(){ //data必须是一个函数,这是默认值data的写法
        return [ 
          {}
        ];
      }
    },
    deliveryPrice: { 
      type: Number,
      default: 0
    },
    minPrice: {
      type: Number,
      default: 0
    }
  },
  data(){
    return {
      fold: true //通过这个变量来控制隐藏和显示购物车列表,true代表隐藏,折叠起来
    }
  },
  computed: {
    totalPrice(){ //计算总价
      let total = 0;
      this.selectFoods.forEach((food) =&gt; {
        total += food.price * food.count; //这个count就是在goods组件里面添加的
      })
      return total;
    },
    totalCount(){ //计算总数量
      let count = 0;
      this.selectFoods.forEach((food) =&gt; {
        count += food.count;
      })
      return count;
    },
    payDesc(){ //只是简单的做一些支付显示的计算
      if (this.totalPrice === 0) {
        return `¥${this.minPrice}元起送`;
      } else if (this.totalPrice &lt; this.minPrice) {
        let diff = this.minPrice - this.totalPrice;
        return `还差¥${diff}元配送`;
      } else {
        return `去结算`;
      }
    },
    payClass(){
      if (this.totalPrice &lt; this.minPrice) {
        return &apos;not-enough&apos;;
      } else {
        return &apos;enough&apos;;
      }
    },
    listShow(){ //自动计算购物车列表是否显示和隐藏
      if (!this.totalCount) { //自动判断商品数量为空
        this.fold = true; //直接隐藏
        return false;
      }
      let show = !this.fold; //当flod为false的时候显示购物车列表
      if (show) { 
        this.$nextTick(() =&gt; { //异步执行滚动列表初始化
          if (!this.scroll) {
            this.scroll = new BScroll(this.$refs.listContent, {
              click: true
            });
          } else {
            this.scroll.refresh();
          }
        });
      }
      return show;
    }
  },
  methods: {
    toggleList(){
      if (!this.totalCount) {
        return;
      }
      this.fold = !this.fold;
    },
    empty() { //通过清空数据属性来控制购物车清空
      this.selectFoods.forEach((food) =&gt; {
        food.count = 0;
      });
    },
    hideList() {
      this.fold = true;
    },
    pay() {
      if (this.totalPrice &lt; this.minPrice) {
        return;
      }
      window.alert(`支付${this.totalPrice}元`);
    }
  },
  components: {
    cartcontrol
  }
}
</code></pre><ul>
<li>购物车列表的显示和隐藏(折叠)是通过数据fold来决定的,他是通过计算属性listshow来实现的,这样达到了不用操作dom就可以改变dom行为的效果,vue的数据驱动设计.</li>
</ul>
<ul>
<li>清空按钮也是这样实现的,通过批量设置count属性来实现</li>
</ul>
<ul>
<li>抛物线小球部分参考:关于购物车添加按钮的动画</li>
</ul>
<ul>
<li>因为打开shopcart详情页会出现两个内容:</li>
</ul>
<pre><code>- shopcart-list部分参考:八.shopcart-list购物车详情页


- cartcontrol部分参考:cartcontrol.vue购物车操作按钮


- 又因为这个cartcontrol是有几个地方都需要用到的,所以将其组件化处理
</code></pre><h2 id="css代码"><a href="#css代码" class="headerlink" title="css代码"></a>css代码</h2><pre><code>  @import &quot;../../common/stylus/mixin.styl&quot;

  .shopcart
    position: fixed //这是固定在页面底部的购物车栏目
    left: 0
    bottom: 0
    z-index: 50 
    width: 100%
    height: 48px
    .content
      display: flex //flex布局
      background: #141d27
      font-size: 0
      .content-left
        flex: 1
        .logo-wrapper
          display: inline-block
          position: relative
          top: -10px //因为要凸出购物车栏目一点点,设计需要
          margin: 0 12px
          padding: 6px
          width: 56px //因为使用了border-box的关系,可以直接写设计的尺寸
          height: 56px
          box-sizing: border-box //border-box可以省去计算border和内边距
          vertical-align: top
          border-radius: 50%
          background: #141d27
          .logo
            width: 100%
            height: 100%
            border-radius: 50%
            text-align: center
            background: #2b343c
            &amp;.highlight
              background: rgb(0, 160, 220)
            .icon-shopping_cart
              line-height: 44px
              font-size: 24px
              color: #80858a
              &amp;.highlight
                color: #ffffff
          .num
            position: absolute
            top: 0
            right: 0
            width: 24px
            height: 16px
            line-height: 16px
            text-align: center
            border-radius: 16px
            font-size: 9px
            color: #ffffff
            background: rgb(240, 20, 20)
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.4)
        .price
          display: inline-block
          vertical-align: top
          margin-top: 12px
          line-height: 24px
          padding-right: 12px
          box-sizing: border-box
          border-right: 1px solid rgba(255, 255, 255, 0.1)
          font-size: 16px
          font-weight: 700
          color: rgba(255, 255, 255, 0.4)
          &amp;.highlight
            color: #ffffff
        .desc
          display: inline-block
          vertical-align: top
          margin: 12px 0 0 12px
          line-height: 24px
          color: rgba(255, 255, 255, 0.4)
          font-size: 10px
      .content-right
        flex: 0 0 105px //flex布局固定右边空间
        width: 105px
        .pay
          height: 48px
          line-height: 48px
          text-align: center
          font-size: 12px
          color: rgba(255, 255, 255, 0.4)
          font-weight: 700
          &amp;.not-enough
            background: #2b333b
          &amp;.enough
            background: #00b43c
            color: #ffffff
//省略了小球动画的css
</code></pre><p><img src="http://oncweb6po.bkt.clouddn.com/3093843777-590c3740aebd9_articlex.png" alt=""></p>
<ul>
<li>这里主要注意border-box的使用,举例logo-wrapper</li>
</ul>
<pre><code>- 宽高都是56px,并且需要实现内边距是6px


- 不用border-box的话,就要计算图片的区域是多大,然后加上6px内边距等于56px


- 用了border-box的话,就不需要计算图片区域了,直接写56px,即使加上6px内边距也不撑大56px的区域,只会自动缩小内部图片区域的区域,实际情况就是外框区域56px,内边距6px,图片自动缩小到44px(6+44+6等于56)
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://super-wei.xyz/2017/09/09/评价列表ratings组件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZhangWei2222">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/person.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZhangWei2222">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/09/评价列表ratings组件/" itemprop="url">评价列表ratings组件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-09T17:56:41+08:00">
                2017-09-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>需要注意的是main.js里面需要取消vue-router的默认路由,src/main.js的router.replace(‘/goods’);需要去掉<br>原因是在添加了其他页面(原来路由只有一个页面goods,现在多了页面ratings)之后,在浏览器加载页面的时候:</p>
<ol>
<li>首先会先加载所有页面</li>
<li>在各个页面都在加载的过程中,会跳到默认路由</li>
<li>然后这些页面被中断了加载,导致了页面内部的一些靠dom渲染的代码无法执行,例如bs-scroll</li>
<li>所以会出现一些报错,TypeError: Cannot read property ‘children’ of undefined<br>所以要做默认路由的时候,直接用url做,不用vue-router自己去跳转,直接写第一个url的地址</li>
</ol>
</blockquote>
<h2 id="主体框架"><a href="#主体框架" class="headerlink" title="主体框架"></a>主体框架</h2><pre><code>&lt;div class=&quot;ratings&quot; ref=&quot;ratings&quot;&gt;
 &lt;div class=&quot;overview&quot;&gt;

 &lt;/div&gt;
&lt;!--里面是所有的内容--&gt;
&lt;/div&gt;
</code></pre><ul>
<li>需要加一个ref,为了让bscroll可以初始化dom</li>
</ul>
<h2 id="ratings内容"><a href="#ratings内容" class="headerlink" title="ratings内容"></a>ratings内容</h2><h3 id="html代码"><a href="#html代码" class="headerlink" title="html代码"></a>html代码</h3><pre><code>&lt;div class=&quot;ratings-content&quot;&gt;
      &lt;div class=&quot;overview&quot;&gt;
        &lt;div class=&quot;overview-left&quot;&gt;
          &lt;h1 class=&quot;score&quot;&gt;{{seller.score}}&lt;/h1&gt;
          &lt;div class=&quot;title&quot;&gt;综合评分&lt;/div&gt;
          &lt;div class=&quot;rank&quot;&gt;高于周边商家{{seller.rankRate}}%&lt;/div&gt;
        &lt;/div&gt;
        &lt;div class=&quot;overview-right&quot;&gt;
        &lt;!--三个一样的模块,服务态度,商品评分,送达时间--&gt;
          &lt;div class=&quot;score-wrapper&quot;&gt;
            &lt;span class=&quot;title&quot;&gt;服务态度&lt;/span&gt;
            &lt;!--引入了star组件--&gt;
            &lt;star :size=&quot;36&quot; :score=&quot;seller.serviceScore&quot;&gt;&lt;/star&gt;
            &lt;span class=&quot;score&quot;&gt;{{seller.serviceScore}}&lt;/span&gt;
          &lt;/div&gt;
          &lt;div class=&quot;score-wrapper&quot;&gt;
            &lt;span class=&quot;title&quot;&gt;商品评分&lt;/span&gt;
            &lt;star :size=&quot;36&quot; :score=&quot;seller.foodScore&quot;&gt;&lt;/star&gt;
            &lt;span class=&quot;score&quot;&gt;{{seller.foodScore}}&lt;/span&gt;
          &lt;/div&gt;
          &lt;div class=&quot;delivery-wrapper&quot;&gt;
            &lt;span class=&quot;title&quot;&gt;送达时间&lt;/span&gt;
            &lt;span class=&quot;delivery&quot;&gt;{{seller.deliveryTime}}分钟&lt;/span&gt;
          &lt;/div&gt;
        &lt;/div&gt;
&lt;/div&gt;
</code></pre><ul>
<li>三个一样的模块共用一套样式代码,分别代入不同的数据</li>
</ul>
<ul>
<li>这里的数据都是获取seller的数据,是父组件传入的props</li>
</ul>
<h3 id="js代码"><a href="#js代码" class="headerlink" title="js代码"></a>js代码</h3><pre><code>import star from &apos;../star/star&apos;;

export default {
  props: {
    seller: {
      type: Object
    }
  },
  components: {
    star
  }
};
</code></pre><h3 id="css代码"><a href="#css代码" class="headerlink" title="css代码"></a>css代码</h3><pre><code>.ratings
  position: absolute
  top: 174px //留空一部分,给header使用
  bottom: 0
  left: 0
  width: 100%
  overflow: hidden
  .overview
    display: flex
    padding: 18px 0
    .overview-left
      flex: 0 0 137px //flex布局,固定左边,右边自动适配
      padding: 6px 0
      width: 137px
      border-right: 1px solid rgba(7, 17, 27, 0.1)
      text-align: center
      @media only screen and (max-width: 320px) //适配i5屏幕
        flex: 0 0 120px //适配的flex数值可以从根据设计稿计算
        width: 120px
      .score
        margin-bottom: 6px
        line-height: 28px
        font-size: 24px
        color: rgb(255, 153, 0)
      .title
        margin-bottom: 8px
        line-height: 12px
        font-size: 12px
        color: rgb(7, 17, 27)
      .rank
        line-height: 10px
        font-size: 10px
        color: rgb(147, 153, 159)
    .overview-right
      flex: 1 //flex布局,固定左边,右边自动适配
      padding: 6px 0 6px 24px
      @media only screen and (max-width: 320px) //适配i5屏幕
        padding-left: 6px
      .score-wrapper //三个一样的模块的共用样式
        margin-bottom: 8px
        font-size: 0
        .title
          display: inline-block
          line-height: 18px //针对模块内部的元素的对齐行,所以需要写到内部元素里面去
          vertical-align: top 
          font-size: 12px
          color: rgb(7, 17, 27)
        .star
          display: inline-block
          margin: 0 12px
          vertical-align: top
        .score
          display: inline-block
          line-height: 18px
          vertical-align: top
          font-size: 12px
          color: rgb(255, 153, 0)
      .delivery-wrapper
        font-size: 0
        .title
          line-height: 18px
          font-size: 12px
          color: rgb(7, 17, 27)
        .delivery
          margin-left: 12px
          font-size: 12px
          color: rgb(147, 153, 159)
</code></pre><ul>
<li>关于适配iphone5,因为设计稿是以iphone6为模板设计的,如果不适配一些小的屏幕的话,对于一些比较宽的div(例如overview-left,overview-right)就会出现换行,被挤压的显示清空,所以需要使用media query来做一些基本的适配,这里只是以iphone5为适配参考,具体做法就是针对不同的屏幕宽度做处理</li>
</ul>
<h2 id="ratingselect组件"><a href="#ratingselect组件" class="headerlink" title="ratingselect组件"></a>ratingselect组件</h2><p>这个引入类似ratingselect组件</p>
<h3 id="html代码-1"><a href="#html代码-1" class="headerlink" title="html代码"></a>html代码</h3><pre><code>&lt;!--引入split组件--&gt;
&lt;split&gt;&lt;/split&gt;
&lt;!-- 引入ratingselect组件 --&gt;
      &lt;ratingselect @select=&quot;selectRating&quot; @toggle=&quot;toggleContent&quot; :selectType=&quot;selectType&quot; :onlyContent=&quot;onlyContent&quot;
                    :ratings=&quot;ratings&quot;&gt;&lt;/ratingselect&gt;
</code></pre><h2 id="ratings列表"><a href="#ratings列表" class="headerlink" title="ratings列表"></a>ratings列表</h2><h3 id="html代码-2"><a href="#html代码-2" class="headerlink" title="html代码"></a>html代码</h3><pre><code>&lt;div class=&quot;rating-wrapper&quot;&gt;
        &lt;ul&gt;
        &lt;!--使用needShow方法控制显示--&gt;
          &lt;li v-for=&quot;rating in ratings&quot; v-show=&quot;needShow(rating.rateType, rating.text)&quot; class=&quot;rating-item&quot;&gt;
            &lt;div class=&quot;avatar&quot;&gt;
              &lt;img width=&quot;28&quot; height=&quot;28&quot; :src=&quot;rating.avatar&quot;&gt;
            &lt;/div&gt;
            &lt;div class=&quot;content&quot;&gt;
              &lt;h1 class=&quot;name&quot;&gt;{{rating.username}}&lt;/h1&gt;
              &lt;div class=&quot;star-wrapper&quot;&gt;
              &lt;!--引入star组件--&gt;
                &lt;star :size=&quot;24&quot; :score=&quot;rating.score&quot;&gt;&lt;/star&gt;
                &lt;span class=&quot;delivery&quot; v-show=&quot;rating.deliveryTime&quot;&gt;{{rating.deliveryTime}}&lt;/span&gt;
              &lt;/div&gt;
              &lt;p class=&quot;text&quot;&gt;{{rating.text}}&lt;/p&gt;
              &lt;!--recommend的处理,尤其注意class跟布局的使用--&gt;
              &lt;div class=&quot;recommend&quot; v-show=&quot;rating.recommend &amp;&amp; rating.recommend.length&quot;&gt;
                &lt;span class=&quot;icon-thumb_up&quot;&gt;&lt;/span&gt;
                &lt;span class=&quot;item&quot; v-for=&quot;item in rating.recommend&quot;&gt;{{item}}&lt;/span&gt;
              &lt;/div&gt;
              &lt;!--过滤时间格式--&gt;
              &lt;div class=&quot;time&quot;&gt;
                {{rating.rateTime | formatDate}}
              &lt;/div&gt;
            &lt;/div&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
&lt;/div&gt;
</code></pre><ul>
<li>需要注意recommend的布局处理</li>
</ul>
<ul>
<li>needShow和过滤时间类似food.vue组件里面使用九.商品详情页food.vue</li>
</ul>
<h3 id="js代码-1"><a href="#js代码-1" class="headerlink" title="js代码"></a>js代码</h3><pre><code>import BScroll from &apos;better-scroll&apos;;
import { formatDate } from &apos;../../common/js/date&apos;; //相对路径导入
import star from &apos;../star/star&apos;;

const ALL = 2; //设置常量,比较好的代码风格,代替直接写数字到代码里面去
const ERR_OK = 0;

export default {
  props: {
    seller: {
      type: Object
    }
  },
  data() {
    return {
      ratings: []
    };
  },
  created() { //初始化数据,从api那里获取
    this.$http.get(&apos;/api/ratings&apos;).then((response) =&gt; {
      response = response.body;
      if (response.errno === ERR_OK) {
        this.ratings = response.data;
        this.$nextTick(() =&gt; { //异步初始化滚动
          this.scroll = new BScroll(this.$refs.ratings, {
            click: true
          });
        });
      }
    });
  },
  methods: {
    needShow(type, text) { //控制显示是否有内容的rate
      if (this.onlyContent &amp;&amp; !text) {
        return false;
      }
      if (this.selectType === ALL) {
        return true;
      } else {
        return type === this.selectType;
      }
    }
  },
  filters: { //过滤时间
    formatDate(time) {
      let date = new Date(time);
      return formatDate(date, &apos;yyyy-MM-dd hh:mm&apos;);
    }
  },
  components: {
    star
  }
};
</code></pre><h3 id="css代码-1"><a href="#css代码-1" class="headerlink" title="css代码"></a>css代码</h3><pre><code>@import &quot;../../common/stylus/mixin.styl&quot;

    .rating-wrapper
      padding: 0 18px
      .rating-item
        display: flex //使用flex布局
        padding: 18px 0
        border-1px(rgba(7, 17, 27, 0.1))
        .avatar
          flex: 0 0 28px //使用flex布局
          width: 28px
          margin-right: 12px
          img
            border-radius: 50%
        .content
          position: relative //重新定义相对布局的参考父div,被内部元素做绝对布局使用
          flex: 1 //使用flex布局
          .name
            margin-bottom: 4px
            line-height: 12px
            font-size: 10px
            color: rgb(7, 17, 27)
          .star-wrapper
            margin-bottom: 6px
            font-size: 0
            .star
              display: inline-block
              margin-right: 6px
              vertical-align: top
            .delivery
              display: inline-block
              vertical-align: top
              line-height: 12px
              font-size: 10px
              color: rgb(147, 153, 159)
          .text
            margin-bottom: 8px
            line-height: 18px
            color: rgb(7, 17, 27)
            font-size: 12px
          .recommend
            line-height: 16px
            font-size: 0
            .icon-thumb_up, .item //共有属性
              display: inline-block
              margin: 0 8px 4px 0 //分配右外边距和下外边距
              font-size: 9px
            .icon-thumb_up //个别属性,因为icon没有颜色,需要配置
              color: rgb(0, 160, 220)
            .item //个别属性
              padding: 0 6px //设置左右内边距,撑开布局,形成类似button的效果
              border: 1px solid rgba(7, 17, 27, 0.1)
              border-radius: 1px
              color: rgb(147, 153, 159)
              background: #fff
          .time
            position: absolute
            top: 0
            right: 0
            line-height: 12px
            font-size: 10px
            color: rgb(147, 153, 159)
</code></pre><ul>
<li>这里的flex布局是左边固定28px,然后右边占满剩下的空间</li>
</ul>
<pre><code>- flex: 0 0 28px 是flex-grow为0(项目不放大比例),flex-shrink为0(项目不缩小比例),flex-basis为28px(固定占用28px)


- flex: 1是flex 1 1 auto的缩写,就是会放大项目比例,并且剩余的项目空间也占有
参考:Flex 布局教程：语法篇
</code></pre><ul>
<li>针对recommend的布局:</li>
</ul>
<pre><code>- 每一个内容都是一个span,span是行内元素,可以并列一行


- 设置外边距是为了span之间能够形成独立的间隙


- 设置内边距是为了让span和文字形成button的效果
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://super-wei.xyz/2017/09/09/学会使用box-sizing布局/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZhangWei2222">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/person.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZhangWei2222">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/09/学会使用box-sizing布局/" itemprop="url">学会使用box-sizing布局</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-09T17:56:26+08:00">
                2017-09-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="盒子模型"><a href="#盒子模型" class="headerlink" title="盒子模型"></a>盒子模型</h2><ul>
<li>关于CSS重要的一个概念就是CSS盒子模型。它控制着页面这些元素的高度和宽度。盒子模型多少会让人产生一些困惑，尤其当涉及到高度和宽度计算的时候。真正盒子的宽度(在页面呈现出来的宽度)和高度，需要加上一些其它的属性，例如：</li>
</ul>
<pre><code>- padding + border + width= 盒子的宽度


- padding+ border + height = 盒子的高度
</code></pre><ul>
<li>这看起来并不是那么直观，那么我们看一个图：</li>
</ul>
<p><img src="http://oncweb6po.bkt.clouddn.com/1480597-fa20b7741a01637b.png" alt=""></p>
<ul>
<li>这意味着，如果我们设置一个宽度为200px，而实际呈现的盒子的宽度可能会大于200px(除非没有左右边框和左右补白)。这可能看起来比较怪，CSS设置的宽度仅仅是内容区的宽度，而非盒子的宽度。同样，高度类似</li>
</ul>
<ul>
<li>这导致的直接结果是当我们希望页面呈现的盒子的宽度是200px的时候，我们需要减去它的左右边框和左右补白，然后设置为对应的CSS宽度。例如上图，我们设置希望盒子宽度为200px，则需要先减去左右补白各20px，左右边框各1px，然后设置对应的CSS宽度158px。</li>
</ul>
<ul>
<li>幸运的是，我们有更好的方法达到我们想要的目的</li>
</ul>
<h2 id="box-sizing"><a href="#box-sizing" class="headerlink" title="box-sizing"></a>box-sizing</h2><ul>
<li><p>语法：box-sizing:  content-box | border-box | inherit;</p>
</li>
<li><p>与上面不同的是，当你设置box-sizing:border-box以后，这就能达到你想要的目的。例如，上面我们想要一个宽度为200px的盒子，那么我们直接设置宽度为200px。是不是看起来清晰多了。当再设置它的左右边框和左右补白后，它的内容区会自动调整。这可能更直接和一目了然。CSS代码如下：</p>
<pre><code>div {
    box-sizing: border-box;
    width: 200px;
    padding: 20px;
    border: 1px solid #DDD;
}
</code></pre></li>
</ul>
<p><img src="http://oncweb6po.bkt.clouddn.com/1480597-fa20b7741a01637b.png" alt=""></p>
<ul>
<li>实际上，这更被设计者和开发者推崇</li>
</ul>
<ul>
<li>一些开发人员觉得box-sizing使用起来十分方便,所以他们主张通过通用选择器将这个属性应用于每个元素</li>
</ul>
<ul>
<li><p>但这样的观点未免有些偏激,而且还会导致不必要的困难,所以更好的方法是只在实际需要时才使用这个属性</p>
<pre><code>*{
     margin:0;
      padding:0;
     box-sizing:border-box;
}
</code></pre></li>
</ul>
<ul>
<li></li>
<li>写上 box-sizing: border-box; ，设置padding值 也不用担心没有减小宽度值而变形</li>
</ul>
<h2 id="box-sizing其它的值"><a href="#box-sizing其它的值" class="headerlink" title="box-sizing其它的值"></a>box-sizing其它的值</h2><ul>
<li>content-box</li>
</ul>
<pre><code>- 描述：在宽度和高度之外绘制元素的内边距和边框。
</code></pre><p><img src="http://oncweb6po.bkt.clouddn.com/1480597-707e492f1498ffd6.png" alt=""></p>
<ul>
<li>border-box</li>
</ul>
<pre><code>- 描述：为元素指定的任何内边距和边框都将在已设定的宽度和高度内进行绘制
</code></pre><p><img src="http://oncweb6po.bkt.clouddn.com/1480597-0d0c50a7d16e7164.png" alt=""></p>
<ul>
<li>inherit</li>
</ul>
<pre><code>- 描述：继承 父元素 box-sizing属性的值
</code></pre><h2 id="浏览器兼容性"><a href="#浏览器兼容性" class="headerlink" title="浏览器兼容性"></a>浏览器兼容性</h2><ul>
<li><p>IE8及以上版本支持该属性，Firefox 需要加上浏览器厂商前缀-moz-，对于低版本的IOS和Android浏览器也需要加上-webkit-。实际上，很多reset.css或者normal.css里都包含如下CSS语句，也是比较赞成的用法：</p>
<pre><code>*, *:before, *:after {
　　-moz-box-sizing: border-box;
　　-webkit-box-sizing: border-box;
　　box-sizing: border-box;
　　}
</code></pre></li>
</ul>
<h2 id="box-sizing-布局三栏目案例"><a href="#box-sizing-布局三栏目案例" class="headerlink" title="box-sizing 布局三栏目案例"></a>box-sizing 布局三栏目案例</h2><pre><code>div{
        height:700px;
        float:left;
}
div.left{
        width:25%;
        background:red;
}
div.cent{
        width:50%;
        box-sizing:border-box;/*可以改变元素以使其宽度包含填充*/
                /* 现在整个元素,包括填充在内,占页面总宽度的50%,所以元素的组合宽度为100%,这全程它们很好地适应于它们的容器.*/
        background:yellow;
        padding:0 20px;/*加了这个会使盒子内容溢出 但是box-sizing很好的自适应了*/
}
div.right{
       width:25%;
        background:blue;
}
&lt;div class=&quot;left&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;cent&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;right&quot;&gt;&lt;/div&gt;
</code></pre><ul>
<li>效果</li>
</ul>
<p><img src="http://oncweb6po.bkt.clouddn.com/1480597-fc7077a82856048c.png" alt=""></p>
<p><img src="http://oncweb6po.bkt.clouddn.com/1480597-446074af9d0ce792.png" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://super-wei.xyz/2017/09/09/ratingselect组件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZhangWei2222">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/person.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZhangWei2222">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/09/ratingselect组件/" itemprop="url">ratingselect组件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-09T17:56:08+08:00">
                2017-09-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://oncweb6po.bkt.clouddn.com/1191015493-590c3b179b4c9_articlex.png" alt=""></p>
<h2 id="html代码"><a href="#html代码" class="headerlink" title="html代码"></a>html代码</h2><blockquote>
<p>备注:父组件food.vue传入的数据</p>
</blockquote>
<pre><code>&lt;ratingselect @select=&quot;selectRating&quot; @toggle=&quot;toggleContent&quot; :selectType=&quot;selectType&quot;
                    :onlyContent=&quot;onlyContent&quot; :desc=&quot;desc&quot;
                    :ratings=&quot;food.ratings&quot;&gt;&lt;/ratingselect&gt;
</code></pre><ul>
<li>方法有:@select=”selectRating” @toggle=”toggleContent”,通过将子组件的方法和父组件的方法进行关联,这样就能够实现跨组件通讯和操作</li>
</ul>
<ul>
<li>属性有::selectType=”selectType”:onlyContent=”onlyContent” :desc=”desc”:ratings=”food.ratings”,这是通过pros传入到子组件的属性,将父组件的数据传到子组件里面,也带有一种通过父组件来初始化子组件属性的意思.<br>##ratingselect的html代码<pre><code>&lt;div class=&quot;ratingselect&quot;&gt;
&lt;!--有使用一个border-1px的mixin--&gt;
  &lt;div class=&quot;rating-type border-1px&quot;&gt;
  &lt;!--绑定一个select方法控制切换,绑定class控制切换之后的按钮样式显示--&gt;
    &lt;span @click=&quot;select(2,$event)&quot; class=&quot;block positive&quot; :class=&quot;{&apos;active&apos;:selectType ===2}&quot;&gt;{{desc.all}}&lt;span
      class=&quot;count&quot;&gt;{{ratings.length}}&lt;/span&gt;&lt;/span&gt;
    &lt;span @click=&quot;select(0,$event)&quot; class=&quot;block positive&quot; :class=&quot;{&apos;active&apos;:selectType ===0}&quot;&gt;{{desc.positive}}&lt;span
      class=&quot;count&quot;&gt;{{positives.length}}&lt;/span&gt;&lt;/span&gt;
    &lt;span @click=&quot;select(1,$event)&quot; class=&quot;block negative&quot; :class=&quot;{&apos;active&apos;:selectType ===1}&quot;&gt;{{desc.negative}}&lt;span
      class=&quot;count&quot;&gt;{{negatives.length}}&lt;/span&gt;&lt;/span&gt;
  &lt;/div&gt;
  &lt;!--绑定一个toggleContent方法来控制有内容和无内容的显示--&gt;
  &lt;div @click=&quot;toggleContent&quot; class=&quot;switch&quot; :class=&quot;{&apos;on&apos;:onlyContent}&quot;&gt;
    &lt;span class=&quot;icon-check_circle&quot;&gt;&lt;/span&gt;
    &lt;span class=&quot;text&quot;&gt;只看有内容的评价&lt;/span&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre></li>
</ul>
<ul>
<li>@click=”select(2,$event)” select方法传入类型和事件,然后在methods里面调用父组件的方法,实现子组件控制父组件的目的</li>
</ul>
<ul>
<li>:class=”{‘active’:selectType ===2}” 根据类型来确定显示的class,实现不同类型显示不同样式的目的</li>
</ul>
<ul>
<li>positives.length 使用计算属性自动计算类型数组的长度,用来显示不同类型的数量</li>
</ul>
<ul>
<li>@click=”toggleContent” :class=”{‘on’:onlyContent}”</li>
</ul>
<pre><code>- toggleContent控制是否展示有内容的rate,也是在methods里面调用父组件的方法,实现子组件控制父组件的目的


- 绑定on这个class来控制该按钮的样式
</code></pre><h2 id="js代码"><a href="#js代码" class="headerlink" title="js代码"></a>js代码</h2><pre><code>const POSITIVE = 0; //设置显示常量
const NEGATIVE = 1;
const ALL = 2;

export default{
  props: {
    ratings: { //传入ratings数组,跟food.ratings关联
      type: Array,
      default(){
        return [];
      }
    },
    selectType: { //跟selectType关联,通过在父组件里面设置这3个值来实现控制子组件的操作
      type: Number,
      default: ALL
    },
    onlyContent: { //跟onlyContent关联
      type: Boolean,
      default: true
    },
    desc: { //跟desc关联
      type: Object,
      default(){
        return {
          all: &apos;全部&apos;,
          positive: &apos;满意&apos;,
          negative: &apos;不满意&apos;
        }
      }
    }
  },
  computed: {
    positives(){ //自动过滤rateType(正向的rate)
      return this.ratings.filter((rating) =&gt; { //js的filter函数会返回一个处理后的(为true)结果的结果数组
        return rating.rateType === POSITIVE;
      })
    },
    negatives(){ //自动过滤rateType(反向的rate)
      return this.ratings.filter((rating) =&gt; {
        return rating.rateType === NEGATIVE;
      })
    }
  },
  methods: {
    select(type, event) { //选择rateType并且通知父组件
      if (!event._constructed) {
        return;
      }
      this.$emit(&apos;select&apos;, type); //调用父组件的方法
    },
    toggleContent(event) { //选择是否显示有内容的rate,并且通知父组件
      if (!event._constructed) {
        return;
      }
      this.$emit(&apos;toggle&apos;);
    }
  }
}
</code></pre><h2 id="css代码"><a href="#css代码" class="headerlink" title="css代码"></a>css代码</h2><pre><code>@import &quot;../../common/stylus/mixin.styl&quot;

.ratingselect
  .rating-type
    padding: 18px 0
    margin: 0 18px
    border-1px(rgba(7, 17, 27, 0.1)) //1像素边框的mixin
    font-size: 0 //去除行内元素间隙
    .block
      display: inline-block
      padding 8px 12px
      margin-right: 8px
      border-radius: 1px
      line-height: 16px
      font-size: 12px
      color: rgb(77, 85, 93)
      &amp;.active //被选中的按钮的class(由:class控制)
        color: #ffffff
      .count
        margin-left: 2px
        font-size: 8px
      &amp;.positive //设置支持的按钮的样式
        background: rgba(0, 160, 220, 0.2)
        &amp;.active
          background: rgb(0, 160, 220)
      &amp;.negative
        background: rgba(77, 85, 93, 0.2)
        &amp;.active
          background: rgb(77, 85, 93)
  .switch
    padding: 12px 18px
    line-height: 24px
    border-bottom: 1px solid rgba(7, 17, 27, 0.1)
    color: rgb(147, 153, 159)
    font-size: 0
    &amp;.on //on的class样式
      .icon-check_circle
        color: #00c850
    .icon-check_circle
      display: inline-block
      vertical-align: top
      margin-right: 4px
      font-size: 24px
    .text
      vertical-align: top
      font-size: 12px
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://super-wei.xyz/2017/09/09/vue-nextTick/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZhangWei2222">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/person.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZhangWei2222">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/09/vue-nextTick/" itemprop="url">vue.nextTick()</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-09T17:55:40+08:00">
                2017-09-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="什么是Vue-nextTick"><a href="#什么是Vue-nextTick" class="headerlink" title="什么是Vue.nextTick()"></a>什么是Vue.nextTick()</h3><p>官方文档解释如下：</p>
<blockquote>
<p>在下次 DOM 更新循环结束之后执行延迟回调。在修改数据之后立即使用这个方法，获取更新后的 DOM。</p>
</blockquote>
<p>我理解的官方文档的这句话的侧重点在最后那半句获取更新后的DOM，获取更新后的DOM言外之意就是什么操作需要用到了更新后的DOM而不能使用之前的DOM或者使用更新前的DOM或出问题，所以就衍生出了这个获取更新后的DOM的Vue方法。所以放在Vue.nextTick()回调函数中的执行的应该是会对DOM进行操作的 js代码，比如Swiper扩展包的</p>
<pre><code>var swiper = new Swiper(&apos;.swiper-container&apos;, {
                    pagination: &apos;.swiper-pagination&apos;,
                    nextButton: &apos;.swiper-button-next&apos;,
                    prevButton: &apos;.swiper-button-prev&apos;,
                    paginationClickable: true,
                    spaceBetween: 30,
                    centeredSlides: true,
                    autoplay: 2500,
                    autoplayDisableOnInteraction: false
                });
</code></pre><h3 id="什么时候需要用的Vue-nextTick"><a href="#什么时候需要用的Vue-nextTick" class="headerlink" title="什么时候需要用的Vue.nextTick()"></a>什么时候需要用的Vue.nextTick()</h3><ul>
<li>你在Vue生命周期的created()钩子函数进行的DOM操作一定要放在Vue.nextTick()的回调函数中。原因是什么呢，原因是在created()钩子函数执行的时候DOM 其实并未进行任何渲染，而此时进行DOM操作无异于徒劳，所以此处一定要将DOM操作的js代码放进Vue.nextTick()的回调函数中。与之对应的就是mounted钩子函数，因为该钩子函数执行时所有的DOM挂载和渲染都已完成，此时在该钩子函数中进行任何DOM操作都不会有问题 。</li>
</ul>
<ul>
<li>在数据变化后要执行的某个操作，而这个操作需要使用随数据改变而改变的DOM结构的时候，这个操作都应该放进Vue.nextTick()的回调函数中。</li>
</ul>
<p>原因是，Vue是异步执行dom更新的，一旦观察到数据变化，Vue就会开启一个队列，然后把在同一个事件循环 (event loop) 当中观察到数据变化的 watcher 推送进这个队列。如果这个watcher被触发多次，只会被推送到队列一次。这种缓冲行为可以有效的去掉重复数据造成的不必要的计算和DOm操作。而在下一个事件循环时，Vue会清空队列，并进行必要的DOM更新。</p>
<p>当你设置 vm.someData = ‘new value’，DOM 并不会马上更新，而是在异步队列被清除，也就是下一个事件循环开始时执行更新时才会进行必要的DOM更新。如果此时你想要根据更新的 DOM 状态去做某些事情，就会出现问题。。为了在数据变化之后等待 Vue 完成更新 DOM ，可以在数据变化之后立即使用 Vue.nextTick(callback) 。这样回调函数在 DOM 更新完成后就会调用。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://super-wei.xyz/2017/09/09/vue过渡动画/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZhangWei2222">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/person.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZhangWei2222">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/09/vue过渡动画/" itemprop="url">vue过渡动画</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-09T17:55:24+08:00">
                2017-09-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在vue中，实现过渡动画一般是下面这样:</p>
<pre><code>&lt;transition name=&quot;fade&quot;&gt;
    &lt;div&gt;&lt;/div&gt;
&lt;/transition&gt;
</code></pre><p>用一个transition对元素或者组件进行封装.<br>在过渡的时候，会有 4 个(CSS)类名在 enter/leave 的过渡中切换。</p>
<ul>
<li>v-enter: 定义进入过渡的开始状态。在元素被插入时生效，在下一个帧移除。</li>
</ul>
<ul>
<li>v-enter-active: 定义进入过渡的结束状态。在元素被插入时生效，在 transition/animation 完成之后移除。</li>
</ul>
<ul>
<li>v-leave: 定义离开过渡的开始状态。在离开过渡被触发时生效，在下一个帧移除。</li>
</ul>
<ul>
<li>v-leave-active: 定义离开过渡的结束状态。在离开过渡被触发时生效，在 transition/animation 完成之后移除。</li>
</ul>
<p>上面是官方文档的原话，但是这4个类名如何运用呢？下面看个例子</p>
<pre><code>&lt;transition name=&quot;fold&quot;&gt;
    &lt;div v-show=&quot;show&quot; class=&quot;example&quot;&gt;&lt;/div&gt;
&lt;/transition&gt;

css:
.example {
    width: 100px;
    height: 100px;
    transform: translate3d(0, -100px, 0);
}
.fold-enter-active, .fold-leave-active {
    transition: all .5s;
}
.fold-enter, .fold-leave-active {
    transform: translate3d(0, 0, 0);
}
</code></pre><blockquote>
<p>当show = true时:</p>
<p>这里的fold-enter，是在元素显示的一瞬间被加入，然后瞬间被移除，在上面的例子中，example这个块状元素本来因为有了transform: translate3d(0, -100px, 0)这个样式，所以被上移了100px,但是因为fold-enter，所以将example这个块状元素移到了原位，但是fold-enter因为瞬间就被移除掉了，所以这时候的元素的样式又变成了transform: translate3d(0, -100px, 0),但是这时候fold-enter-active这个样式就生效了，因为设置了transition: all .5s,所以元素会在0.5s的时间内上移100px,在过渡动画结束之后,fold-enter-active这个类马上被移除.</p>
<p>当show = false时:</p>
<p>example不会马上消失，这个时候fold-leave-active这个类就起作用了,example这时的位置是在-100px，fold-leave-active定义的是过渡的结束状态：transform: translate3d(0, 0, 0);，但是同时又设置了transition: all .5s，所以这时元素会在0.5s的时间内下移100px.之后fold-leave-active被移除.</p>
</blockquote>
<p>另外，还可以在动画中调用js钩子函数:</p>
<pre><code>&lt;transition
  v-on:before-enter=&quot;beforeEnter&quot;
  v-on:enter=&quot;enter&quot;
  v-on:after-enter=&quot;afterEnter&quot;
  v-on:enter-cancelled=&quot;enterCancelled&quot;
  v-on:before-leave=&quot;beforeLeave&quot;
  v-on:leave=&quot;leave&quot;
  v-on:after-leave=&quot;afterLeave&quot;
  v-on:leave-cancelled=&quot;leaveCancelled&quot;
&gt;
&lt;/transition&gt;
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://super-wei.xyz/2017/09/09/vue的v-if与v-show/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZhangWei2222">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/person.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZhangWei2222">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/09/vue的v-if与v-show/" itemprop="url">vue的v-if与v-show</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-09T17:55:02+08:00">
                2017-09-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-共同点"><a href="#1-共同点" class="headerlink" title="1.共同点"></a>1.共同点</h3><p>都是动态显示DOM元素</p>
<h3 id="2-区别"><a href="#2-区别" class="headerlink" title="2.区别"></a>2.区别</h3><p>（1）手段：v-if是动态的向DOM树内添加或者删除DOM元素；v-show是通过设置DOM元素的display样式属性控制显隐；</p>
<p>（2）编译过程：v-if切换有一个局部编译/卸载的过程，切换过程中合适地销毁和重建内部的事件监听和子组件；v-show只是简单的基于css切换；</p>
<p>（3）编译条件：v-if是惰性的，如果初始条件为假，则什么也不做；只有在条件第一次变为真时才开始局部编译（编译被缓存？编译被缓存后，然后再切换的时候进行局部卸载); v-show是在任何条件下（首次条件是否为真）都被编译，然后被缓存，而且DOM元素保留；</p>
<p>（4）性能消耗：v-if有更高的切换消耗；v-show有更高的初始渲染消耗；</p>
<p>（5）使用场景：v-if适合运营条件不大可能改变；v-show适合频繁切换。</p>
<h3 id="Tips："><a href="#Tips：" class="headerlink" title="Tips："></a>Tips：</h3><p>（1）如果v-show作用的元素，css文件中display:none，通过v-show进行设置不能显示该元素；<br>原因：v-show控制显隐，是通过js代码去修改元素的element style，如果value为false，设置display: none;如果value为true，设置display: ‘’；于是value为true时，只能将element style中的display效果清除，并不能覆盖css中的display效果；<br>如下图所示，value=true时，v-show改变的是element.style，由于无效，显示效果由css文件中的display决定。</p>
<p><img src="http://oncweb6po.bkt.clouddn.com/605230-20160422103435320-1044614315.png" alt=""></p>
<h3 id="解决办法："><a href="#解决办法：" class="headerlink" title="解决办法："></a>解决办法：</h3><p>使用v-show的话，在vue解析之前隐藏DOM的话，尽量在style属性里面设置display的值，不要在css文件中。</p>
<pre><code>&lt;ul v-touch:tap=&quot;message=2&quot; style=&quot;display: none&quot; v-show=&quot;show&quot;&gt;
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://super-wei.xyz/2017/09/09/shopcart-list购物车列表页/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZhangWei2222">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/person.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZhangWei2222">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/09/shopcart-list购物车列表页/" itemprop="url">shopcart-list购物车列表页</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-09T17:54:36+08:00">
                2017-09-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>需要使用better-scroll进行列表内容滚动绑定</li>
</ul>
<ul>
<li>使用vue2的transition动画过渡处理动画</li>
</ul>
<ul>
<li><p>使用子组件cartcontrol处理购物车的添加删除操作cartcontrol.vue购物车操作按钮</p>
<pre><code>&lt;!--transition是vue2的动画格式--&gt;
&lt;transition name=&quot;fold&quot;&gt; 
    &lt;div class=&quot;shopcart-list&quot; v-show=&quot;listShow&quot;&gt;
        &lt;div class=&quot;list-header&quot;&gt;&lt;/div&gt;
        &lt;div class=&quot;list-content&quot; ref=&quot;listContent&quot;&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/transition&gt;
</code></pre></li>
</ul>
<h2 id="购物车详情内容shopcart-list"><a href="#购物车详情内容shopcart-list" class="headerlink" title="购物车详情内容shopcart-list"></a>购物车详情内容shopcart-list</h2><p>一共有两块,list-header,list-content,这是根据设计稿内容确定的</p>
<h3 id="list-header"><a href="#list-header" class="headerlink" title="list-header"></a>list-header</h3><p>绑定清空按钮</p>
<pre><code>&lt;div class=&quot;list-header&quot;&gt;
            &lt;h1 class=&quot;title&quot;&gt;购物车&lt;/h1&gt;
            &lt;!--绑定empty方法清空购物车内容--&gt;
            &lt;span class=&quot;empty&quot; @click=&quot;empty&quot;&gt;清空&lt;/span&gt;
&lt;/div&gt;
</code></pre><p>通过设置selectFoods里面所有数据的count为0来实现清空的目的</p>
<pre><code>empty() { //清空购物车内容
        this.selectFoods.forEach((food) =&gt; {
          food.count = 0;
        });
      },
</code></pre><h3 id="list-content"><a href="#list-content" class="headerlink" title="list-content"></a>list-content</h3><p>这里也分开两部分来说:</p>
<p>第一部分:</p>
<ul>
<li>使用ref来绑定一个dom,然后被vue使用,ref=”listContent”,这是为了将list-content的dom被使用,然后实例化better-scroll实现滚动list的效果</li>
</ul>
<ul>
<li>购物车的清单是通过遍历selectFoods数组(通过父组件goods处理并传入goods.vue)得到的,v-for=”food in selectFoods”</li>
</ul>
<ul>
<li>shopcart-list本身也有一个渐入渐出的动画</li>
</ul>
<ul>
<li>list-content本身没有高度,是靠header和content撑开</li>
</ul>
<p>第二部分:</p>
<ul>
<li>复用子组件cartcontrol,因为这个子组件在购物车内容和购物车详情页的列表里都有使用,所以单独独立出来,复用代码 <cartcontrol @add="addFood" :food="food"></cartcontrol></li>
</ul>
<ul>
<li>子组件cartcontrol会有2个动画,一个动画是他自己本身的水平滚动,一个是动画是要跟shopcart关联的抛物线滚动cartcontrol.vue购物车操作按钮</li>
<li><p>代码部分:<br>html代码</p>
<pre><code>&lt;!--ref是用来给better-scroll绑定的dom--&gt;
&lt;div class=&quot;list-content&quot; ref=&quot;listContent&quot;&gt;
  &lt;ul&gt;
  &lt;!--遍历selectFoods获得被勾选的所有数据--&gt;
    &lt;li class=&quot;food&quot; v-for=&quot;food in selectFoods&quot;&gt;
      &lt;span class=&quot;name&quot;&gt;{{food.name}}&lt;/span&gt;
      &lt;div class=&quot;price&quot;&gt;
        &lt;span&gt;￥{{food.price * food.count}}&lt;/span&gt;
      &lt;/div&gt;
      &lt;!--购物车详情列表里面的购物车按钮组件cartcontrol--&gt;
      &lt;div class=&quot;cartcontrol-wrapper&quot;&gt;
        &lt;cartcontrol @add=&quot;addFood&quot; :food=&quot;food&quot;&gt;&lt;/cartcontrol&gt;
      &lt;/div&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre></li>
</ul>
<h3 id="js代码"><a href="#js代码" class="headerlink" title="js代码"></a>js代码</h3><pre><code>import BScroll from &apos;better-scroll&apos;; //导入better-scroll
import cartcontrol from &apos;../../components/cartcontrol/cartcontrol&apos;; //导入cartcontrol组件

export default{ //导出到当前vue文件内使用
  props: { //父组件goods传入数据
    selectFoods: { //被勾选的所有foods的数据
      type: Array, //默认值类型
      default(){ //默认值,并且vue的data数据是一个函数写法实现的
        return [
          {}
        ];
      }
    },
  },
  data(){
    return {
      fold: true // 控制购物车折叠效果的标志,默认是true代表折叠
    }
  },
  computed: {
    totalCount(){ //在这里被用来判断购物车是否有东西
      let count = 0;
      this.selectFoods.forEach((food) =&gt; {
        count += food.count;
      })
      return count;
    },
    listShow(){ //购物车是否展示内部列表处理
      if (!this.totalCount) { //判断没有数量的情况
        this.fold = true; //折叠属性设置为true,即折叠起来,主要是更新fold的状态
        return false; //返回false是给v-show使用,false会display none
      }
      let show = !this.fold; //使用fold的状态取反来实现常用的切换状态处理逻辑
       if (show) { //展示购物车列表内容
        this.$nextTick(() =&gt; { //异步处理,提高体验,防止卡顿
          if (!this.scroll) { //如果没有绑定过better-scroll就绑定一个
          //用$refs来绑定vue的dom元素
            this.scroll = new BScroll(this.$refs.listContent, {
              click: true //让better-scroll将click事件也传递
            });
          } else { //使用better-scroll的内置事件refresh直接更新绑定,不用重新实例化一次better-scroll
            this.scroll.refresh();
          }
        });
      }
      return show; //返回布尔值给v-show使用
    }
  },
  methods: {
    toggleList(){ //封装一个方法来控制购物车列表的显示
      if (!this.totalCount) {
        return;
      }
      this.fold = !this.fold; //切换状态的处理
    },
  },
  components: {
    cartcontrol //注册cartcontrol组件,以便当前vue文件能够调用
  }
</code></pre><p>css代码</p>
<pre><code>@import &quot;../../common/stylus/mixin.styl&quot;

   .shopcart-list
      position: absolute //因为需要固定在app主界面的底部(非footer)
      left: 0
      top: 0
      z-index: -1 //因为要避免遮挡footer的图标
      width: 100%
      transform: translate3d(0, -100%, 0) //设置css方式的vue动画初始值,纵坐标的-100%是指相反方向的当前元素的100%高度,这是&quot;入&quot;
      &amp;.fold-enter-active, &amp;.fold-leave-active //shopcart-list的渐入渐出动画,这是&quot;渐&quot;
        transition: all 0.5s //全部元素0.5秒过渡变化
      &amp;.fold-enter, &amp;.fold-leave-active // 这是&quot;出&quot;
        transform: translate3d(0, 0, 0) //3d变形
      .list-header
        height: 40px 
        line-height: 40px
        padding: 0 18px
        background: #f3f5f7
        border-bottom: 1px solid rgba(7, 17, 27, 0.1)
        .title
          float: left
          font-size: 14px
          color: rgb(7, 17, 27)
        .empty
          float: right
          font-size: 12px
          color: rgb(0, 160, 220)

      .list-content
        padding: 0 18px
        max-height: 217px //因为不固定高度,所以用max-height
        overflow: hidden //要实现滚动,就要隐藏超出部分
        background: #fff
        .food
          position: relative
          padding: 12px 0
          box-sizing: border-box
          border-1px(rgba(7, 17, 27, 0.1))//要处理1px边框问题,引入mixin.styl
          .name
            line-height: 24px
            font-size: 14px
            color: rgb(7, 17, 27)
          .price
            position: absolute
            right: 90px
            bottom: 12px
            line-height: 24px
            font-size: 14px
            font-weight: 700
            color: rgb(240, 20, 20)
          .cartcontrol-wrapper
            position: absolute
            right: 0
            bottom: 6px
</code></pre><h2 id="购物车遮罩list-mask"><a href="#购物车遮罩list-mask" class="headerlink" title="购物车遮罩list-mask"></a>购物车遮罩list-mask</h2><pre><code>&lt;!--购物车详情页的遮罩并且动画处理--&gt;
&lt;transition name=&quot;fade&quot;&gt;
  &lt;div class=&quot;list-mask&quot; @click=&quot;hideList&quot; v-show=&quot;listShow&quot;&gt;&lt;/div&gt;
&lt;/transition&gt;
</code></pre><hr>
<pre><code>hideList() { //遮罩隐藏
        this.fold = true;
      },
</code></pre><ul>
<li>遮罩的动画是普通的渐隐渐现,使用css3实现</li>
</ul>
<ul>
<li>只需要操作数据属性就能够实现</li>
</ul>
<ul>
<li>遮罩的层级是跟shopcart-list同级的,是因为同一层</li>
</ul>
<ul>
<li><p>遮罩触发会放到shopcart组件的content元素,使用的方法是toggleList</p>
<pre><code>.list-mask //遮罩的样式
  position: fixed
  top: 0
  left: 0
  width: 100%
  height: 100%
  z-index: 40
  backdrop-filter: blur(10px) //遮罩虚化
  opacity: 1
  background: rgba(7, 17, 27, 0.6)
  &amp;.fade-enter-active, &amp;.fade-leave-active //遮罩动画
    transition: all 0.5s
  &amp;.fade-enter, &amp;.fade-leave-active
    opacity: 0
    background: rgba(7, 17, 27, 0)
</code></pre></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/person.jpg"
               alt="ZhangWei2222" />
          <p class="site-author-name" itemprop="name">ZhangWei2222</p>
           
              <p class="site-description motion-element" itemprop="description">Dream high</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/">
                <span class="site-state-item-count">61</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">30</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZhangWei2222</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动</div>

  <span class="post-meta-divider">|</span>

  <div class="theme-info">主题 &mdash; <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.2</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
